extends layout

block header
    script(src='/javascripts/form.js')
    title #{title}

block content
    h1= title
    hr
    input#default-number(type='hidden' value='#{default_number}')
    form(method='post' action='form_submit')
        input(type='hidden' value='#{name}' name='name')
        input(type='hidden' value='#{form.name}' name='form-name')
        each item in form.items
            h3 #{item.name}
            each size in item.sizes
                .size
                    .hidden.item-name #{item.name}-#{size}
                    .form-group
                        label= size
                        // Check to see if the user has already ordered something
                        - var found_item = false
                        if order.items
                            each order_item in order.items
                                if order_item.name === item.name + '-' + size
                                    input.form-control.quantity(type='number' name='quantity-#{item.name}-#{size}' min='0' max='10', value='#{order_item.quantity}')
                                    - var count = 1
                                    each number in order_item.numbers
                                        .form-group.col-xs-offset-1.number
                                            if count === 1
                                                br
                                            label Number:
                                            input.form-control(type='number' name='number-#{item.name}-#{size}-#{count}' value='#{number}' placeholder='Number')
                                            - count++
                                    - found_item = true

                        unless found_item
                            input.form-control.quantity(type='number' name='quantity-#{item.name}-#{size}' min='0' max='10', value='0')
            each subitem in item.subitems
                hr
                h4 #{subitem.name}
                .form-group
                    each size in subitem.sizes
                        .size
                            .hidden.item-name #{subitem.name}-#{size}
                            .form-group
                                label= size
                                // Check to see if the user has already ordered something
                                - var found_sub_item = false
                                if order.items
                                    each order_item in order.items
                                        if order_item.name === subitem.name + '-' + size
                                            input.form-control.quantity(type='number' name='quantity-#{subitem.name}-#{size}' min='0' max='10', value='#{order_item.quantity}')
                                            - var count = 1
                                            each number in order_item.numbers
                                                .form-group.col-xs-offset-1.number
                                                    label Number:
                                                    input.form-control(type='number' name='number-#{item.name}-#{size}-#{count}' value='#{number}' placeholder='Number')
                                                    - count++
                                            - found_sub_item = true

                                unless found_sub_item
                                    input.form-control.quantity(type='number' name='quantity-#{subitem.name}-#{size}' min='0' max='10' value='0')
        button.btn.btn-primary(type='submit') Submit
